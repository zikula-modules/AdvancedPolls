<!--[*  $Id$  *]-->
<!--[include file="advancedpolls_admin_menu.htm"]-->
<script type="text/javascript" src="modules/advanced_polls/pnincludes/picker.js"></script>
<!--[pnajaxheader modname=advanced_polls filename=ap_admin_newmodify.js effects=true nobehaviour=true noscriptaculous=true]-->
<!--[gt text="Edit Poll" assign=templatetitle]-->
<div class="z-admincontainer">
    <div class="z-adminpageicon"><!--[pnimg modname='core' src='edit.gif' set='icons/large' alt=$templatetitle]--></div>
    <h2><!--[$templatetitle]--></h2>
    <form class="z-form" id="advanced_polls_admin_modify" action="<!--[pnmodurl modname="advanced_polls" type="admin" func="update"]-->" method="post" enctype="application/x-www-form-urlencoded">
        <div>
            <input type="hidden" name="authid" value="<!--[insert name=generateauthkey module="advanced_polls"]-->" />
            <input type="hidden" name="poll[pollid]" value="<!--[$pollid|pnvarprepfordisplay]-->" />
            <fieldset>
                <legend><!--[gt text="Basic Information"]--></legend>
                <div class="z-formrow">
                    <label for="advancedpolls_title"><!--[gt text="Name of poll"]--></label>
                    <input id="advancedpolls_title" name="poll[title]" type="text" size="50" maxlength="100" value="<!--[$title|pnvarprepfordisplay]-->" />
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_urltitle"><!--[gt text="PermaLink URL title"]--></label>
                    <input id="advancedpolls_urltitle" name="poll[urltitle]" type="text" size="50" maxlength="120" value="<!--[$urltitle|pnvarprepfordisplay]-->" />
                    <em class="z-formnote z-sub"><!--[gt text="(Blank = auto-generate)"]--></em>
                </div>
                <!--[if $enablecategorization]-->
                <div class="z-formrow">
                    <label><!--[gt text="Category"]--></label>
                    <!--[nocache]-->
                    <!--[foreach from=$catregistry key=property item=category]-->
                    <!--[array_field_isset array=$__CATEGORIES__ field=$property assign="catExists"]-->
                    <!--[if $catExists]-->
                    <!--[array_field_isset array=$__CATEGORIES__.$property field="id" returnValue=1 assign="selectedValue"]-->
                    <!--[else]-->
                    <!--[assign var="selectedValue" value="0"]-->
                    <!--[/if]-->
                    <div class="z-formlist"><!--[selector_category category=$category name="poll[__CATEGORIES__][$property]" field="id" selectedValue=$selectedValue defaultValue="0" __defaultText='Choose Category']--></div>
                    <!--[/foreach]-->
                    <!--[/nocache]-->
                </div>
                <!--[/if]-->
                <div class="z-formrow">
                    <label for="advancedpolls_description"><!--[gt text="Description"]--></label>
                    <textarea id="advancedpolls_description" name="poll[description]" rows="10" cols="50"><!--[$description|pnvarprephtmldisplay]--></textarea>
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_language"><!--[gt text="Language"]--></label>
                    <!--[html_select_languages id="advancedpolls_language" name="poll[language]" installed=true all=true selected=$language]-->
                </div>
            </fieldset>
            <fieldset>
                <legend><!--[gt text="Timing"]--></legend>
                <div class="z-formrow">
                    <label for="advancedpolls_startdate"><!--[gt text="Date and time poll opens"]--></label>
                    <div id="advancedpolls_startdate" style="white-space:nowrap">
                        <!--[html_select_date year_as_text=true prefix="start" time=$opendate]--><!--[html_select_time use_24_hours=true display_seconds=false prefix="start" time=$opendate]-->
                    </div>
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_noclosedate"><!--[gt text="No close date"]--></label>
                    <!--[if $closedate eq 0]-->
                    <input type="checkbox" id="advancedpolls_noclosedate" name="poll[noclosedate]" value="1" checked="checked" />
                    <!--[else]-->
                    <input type="checkbox" id="advancedpolls_noclosedate" name="poll[noclosedate]" value="1" />
                    <!--[/if]-->
                </div>
                <div id="advancedpolls_closedate_container" class="z-formrow">
                    <label for="advancedpolls_closedate"><!--[gt text="Date and time poll closes"]--></label>
                    <div id="advancedpolls_closedate" style="white-space:nowrap">
                        <!--[html_select_date year_as_text=true prefix="close" time=$closedate]--><!--[html_select_time use_24_hours=true display_seconds=false prefix="close" time=$closedate]-->
                    </div>
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_recurring"><!--[gt text="Recurring poll?"]--></label>
                    <select id="advancedpolls_recurring" name="poll[recurring]">
                        <!--[if $recurring eq 0]-->
                        <option value="0" selected="selected"><!--[gt text="No"]--></option>
                        <option value="1"><!--[gt text="Yes"]--></option>
                        <!--[else]-->
                        <option value="0"><!--[gt text="No"]--></option>
                        <option value="1" selected="selected"><!--[gt text="Yes"]--></option>
                        <!--[/if]-->
                    </select>
                </div>
                <div id="advancedpolls_recurring_container">
                    <p class="z-formnote z-informationmsg"><!--[gt text="The following options are only relevant if a recurring poll is selected."]--></p>
                    <div class="z-formrow">
                        <label for="advancedpolls_recurringoffset"><!--[gt text="Recurring offset"]--></label>
                        <input id="advancedpolls_recurringoffset" name="poll[recurringoffset]" type="text" size="5" maxlength="5" value="<!--[$recurringoffset|pnvarprepfordisplay]-->" />
                        <em class="z-sub z-formnote"><!--[gt text="Number of hours after the close date the poll reopens"]--></em>
                    </div>
                    <div class="z-formrow">
                        <label for="advancedpolls_recurringinterval"><!--[gt text="Recurrence interval"]--></label>
                        <input id="advancedpolls_recurringinterval" name="poll[recurringinterval]" type="text" size="5" maxlength="5" value="<!--[$recurringinterval|pnvarprepfordisplay]-->" />
                        <em class="z-sub z-formnote"><!--[gt text="Number of days the poll will recur"]--></em>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend><!--[gt text="Voting regulations"]--></legend>
                <div class="z-formrow">
                    <label for="advancedpolls_voteauthtype"><!--[gt text="Poll authorisation method"]--></label>
                    <select id="advancedpolls_voteauthtype" name="poll[voteauthtype]">
                        <!--[votingtypes selected=$voteauthtype]-->
                    </select>
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_tiebreakalg"><!--[gt text="Tiebreak method"]--></label>
                    <select id="advancedpolls_tiebreakalg" name="poll[tiebreakalg]">
                        <!--[tiebreaktypes selected=$tiebreakalg]-->
                    </select>
                </div>
                <div class="z-formrow">
                    <label for="advancedpolls_multipleselect"><!--[gt text="Selection method"]--></label>
                    <select id="advancedpolls_multipleselect" name="poll[multipleselect]">
                        <!--[multipleselecttypes selected=$multipleselect]-->
                    </select>
                </div>
                <div id="advancedpolls_multipleselect_container">
                    <p class="z-formnote z-informationmsg"><!--[gt text="Following option only relevant if a multiple selection poll is selected"]--></p>
                    <div class="z-formrow">
                        <label for="advancedpolls_multipleselectcount"><!--[gt text="You may select "]--></label>
                        <input id="advancedpolls_multipleselectcount" name="poll[multipleselectcount]" type="text" size="5" maxlength="5" value="<!--[$multipleselectcount|pnvarprepfordisplay]-->" />
                        <em class="z-formnote z-sub"><!--[gt text="(-1 for Unlimited selections)"]--></em>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <!--[assign var="polloptions" value=$options]-->
                <legend><!--[gt text="Options"]--></legend>
                <!--[section name=polloptions loop=$polloptions]-->
                <!--[assign var="rowcount" value=$smarty.section.polloptions.rownum]-->
                <!--[assign var="arraycount" value=$rowcount-1]-->
                <div class="z-formrow">
                    <label for="advancedpolls_option<!--[$rowcount]-->"><!--[gt text="Poll option"]--> <!--[$rowcount]--></label>
                    <div>
                        <input id="advancedpolls_option<!--[$rowcount]-->" type="text" name="poll[options][<!--[$rowcount]-->][optiontext]" size="50" maxlength="255" value="<!--[$polloptions.$arraycount.optiontext|pnvarprepfordisplay]-->" />
                        <input id="advancedpolls_option<!--[$rowcount]-->color" type="text" name="poll[options][<!--[$rowcount]-->][optioncolour]" size="7" maxlength="7" value="<!--[$polloptions.$arraycount.optioncolour|pnvarprepfordisplay]-->" />
                        <a href="javascript:TCP.popup(document.forms['advanced_polls_admin_modify'].elements['advancedpolls_option<!--[$rowcount]-->color'])"><img width="15" height="13" alt="Click Here to pick the color" src="modules/advanced_polls/pnimages/sel.gif" /></a>
                    </div>
                </div>
                <!--[/section]-->
                <div class="z-formrow">
                    <label for="advancedpolls_optioncount"><!--[gt text="Number of options in this poll"]--></label>
                    <input id="advancedpolls_optioncount" name="poll[optioncount]" type="text" size="3" maxlength="3" value="<!--[$optioncount|pnvarprepfordisplay]-->" />
                </div>
            </fieldset>
            <fieldset>
                <legend><!--[gt text="Meta data"]--></legend>
                <ul>
                    <!--[pnusergetvar name=uname uid=$cr_uid assign=username]-->
                    <li><!--[gt text="Created by %s" tag1=$username]--></li>
                    <li><!--[gt text="Created on %s" tag1=$cr_date|pndate_format]--></li>
                    <!--[pnusergetvar name=uname uid=$lu_uid assign=username]-->
                    <li><!--[gt text="Last updated by %s" tag1=$username]--></li>
                    <li><!--[gt text="Updated on %s" tag1=$lu_date|pndate_format]--></li>
                </ul>
            </fieldset>
            <!--[pnmodcallhooks hookobject=item hookaction=modify hookid=$pollid module=Polls]-->
            <div class="z-formbuttons">
                <!--[pnbutton src='button_ok.gif' set='icons/small' __alt="Update" __title="Update"]-->
                <a href="<!--[pnmodurl modname=advanced_polls type=admin func=view]-->"><!--[pnimg modname='core' src='button_cancel.gif' set='icons/small'   __alt="Cancel" __title="Cancel"]--></a>
            </div>
        </div>
    </form>
</div>